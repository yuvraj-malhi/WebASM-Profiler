<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <style>
        #spanOutput{
            display:block;
            width:100%;
            height:20px;
            text-align:center;
        }
    </style>
    <style>
        #timeTaken{
            display:block;
            width:100%;
            height:20px;
            text-align:center;
        }
    </style>
    <script src="script.js"></script>
    <script src="arithmeticJS.js"></script>
</head>
<body>

    <h1>JS - WASM Benchmarking Tool</h1>
    
    <label for="inputNumber">Enter a number:</label>
    <input type="number" id="inputNumber" step="any" placeholder="Enter a number">

    <br>
    <label for="iterationsNumber">(Optional) Enter iterations:</label>
    <input type="iterations" id="iterationsNumber" step="any" placeholder="Enter iterations">

    <br>
    <br>
    <br><button onclick="performOperation('log')">Natural Logarithm (log)</button>
    <br><button onclick="performOperation('sin')">Sine (sin)</button>
    <br><button onclick="performOperation('exp')">Exponential (exp)</button>
    <br><button onclick="performOperation('cos')">Cosine (cos)</button>
    <br><button onclick="performOperation('piL')">Pi (Leibniz)</button>
    <br><button onclick="performOperation('piB')">Pi (Bailey-Borwein-Plouffe)</button>
    <br><button onclick="performOperation('ratio')">Golden Ratio (Iterative)</button>
    <br><button onclick="performOperation('rFibb')">Golden Ratio (Fibonacci)</button>
    <br>

    <br>
    <table id="resultsTable">
        <thead>
            <tr>
                <th>Operation</th>
                <th>Input Number</th>
                <th>Iterations</th>
                <th>Result</th>
                <th>Time Taken (JS)</th>
                <th>Time Taken (WS)</th>
            </tr>
        </thead>
        <tbody id="resultsBody">
            <!-- Results will be added here -->
        </tbody>
    </table>

    <script>

        function setResult(result) {
            document.getElementById('result').innerText = `Result: ${result}`;
        }

        var startTime, endTime;
        function start() {
            startTime = new Date();
        };

        function end() {
            endTime = new Date();
            var timeDiff = endTime - startTime; //in ms
            // strip the ms
            return timeDiff;
        }


        function performOperation(operation) {
            const inputNumber = parseFloat(document.getElementById('inputNumber').value);
            var iterations = 0; 
            var iterInput = parseFloat(document.getElementById('iterationsNumber').value);
            if(iterInput != NaN && iterInput != 0 && iterInput > 0)
                iterations = iterInput
            else
                iterations = 30; // Default value of iterations

            var result = 0;
            var timeTakenWS = 0;
            var timeTakenJS = 0;

            
            
            switch (operation) {

                case 'log':
                    start();
                    result = wasmExports.logWS(inputNumber, iterations);
                    timeTakenWS = end();
                    start();
                    result = logJS(inputNumber, iterations);
                    timeTakenJS = end();
                    break;

                case 'piL':
                    start();
                    result = wasmExports.piLeibnizWS(iterations);
                    timeTakenWS = end();
                    start();
                    result = piLeibnizJS(iterations);
                    timeTakenJS = end();
                    break;

                case 'piB':
                    start();
                    result = wasmExports.piBBPWS(iterations);
                    timeTakenWS = end();
                    start();
                    result = piBBPJS(iterations);
                    timeTakenJS = end();
                    break;

                case 'ratio':
                    start();
                    result = wasmExports.ratioWS(iterations);
                    timeTakenWS = end();
                    start();
                    result = ratioJS(iterations);
                    timeTakenJS = end();
                    break;

                case 'rFibb':
                    start();
                    result = wasmExports.ratioFibbWS(iterations);
                    timeTakenWS = end();
                    start();
                    result = ratioFibbJS(iterations);
                    timeTakenJS = end();
                    break;

                case 'sin':

                    result = wasmExports.sinWS(inputNumber, iterations);
                    break;
                case 'exp':

                    result = wasmExports.expWS(inputNumber, iterations);
                    break;
                case 'cos':
 
                    result = wasmExports.cosWS(inputNumber, iterations);
                    break;
                default:
                    result = "Invalid operation";
            }
            
            


            displayResult(operation, inputNumber, iterations, result, timeTakenJS, timeTakenWS);
        }

        function displayResult(operation, inputNumber, iterations, result, timeTakenJS, timeTakenWS) {
            const tableBody = document.getElementById('resultsBody');
            const newRow = tableBody.insertRow();

            const cellOperation = newRow.insertCell(0);
            const cellInputNumber = newRow.insertCell(1);
            const celliterations = newRow.insertCell(2);
            const cellResult = newRow.insertCell(3);
            const celltimeJS = newRow.insertCell(4);
            const celltimeWS = newRow.insertCell(5);

            cellOperation.innerText = operation;
            cellInputNumber.innerText = inputNumber;
            cellResult.innerText = result;
            celliterations.innerText = iterations;
            celltimeJS.innerText = timeTakenJS;
            celltimeWS.innerText = timeTakenWS;
        }

    </script>
</body>
</html>